Рекомендательная система для новостного портала.

Рекомендательная система - это вещь с которой сталкивался каждый житель интернета в той или иной мере, но как она работает? В месте с ней часто употрябляют магические слова: 'машинное обучение', 'анализ данных', но что это такое?
Всё началось с того, что нам предложили заняться разработкой рекомендательной системы для портала 'Дождя'. 

Зачем нужна рекомендательная система?
Рекомендательная система - это система, которая упрощает жизнь пользователя. С помощью неё ваш путь по сайту меняется - вам не нужно постоянно возвращаться на главную страницу и искать релевантные новости, эти новости будут отображаться конкретно для вас в той новости, которую вы читаете.


С чего начать

Основой рекомендательной системы являлась бинарная классификиция. Бинарная классификация - это одна из самых распространённых проблем машинного обучения. К ней можно свести множество очень интересных и важных проблем. Как следует из названия бинарная классификация - это разделение объектов на 2 класса. Но что же можно разделять в новостях?

Данные

В данных, которые мы содержалась информация о 'перемещении' пользователя. Когда и куда он заходил на сайте, какие новости читал. С помощью этих данных мы выстроили сеанс пользователя. В сеансе пользователя содержалось n статей, которые он посещал в один периуд времени. Мы взяли три статьи из сеанса пользователя и сгенерировали для них 'features' - фичи для бинарного классификатора (об этом ниже). В бинарный классификатор попадают 4 статьи - 3, которые мы взяли из сеанса пользователя, они никогда не меняются, а 4 - новость, которая была опубликована в ближайшее 5 часов (об этом тоже ниже). Далее с помощью бинарного классификатора мы предсказываем на сколько подходит статья пользователю. 1 - подходит идеально, 0 - не подходит вообще.

И так, магическая константа 5 часов - она была получина отнють не рандомом, а с помощью того самого анализа данных. Проанализировав все сеансы пользователей мы получили график зависимости количества просмотров новости от времени существования новости - и вот, что у нас получилось:

Features

Фичи - это преобразование данных в машиночитаймый вид, например мы не можем просто так загнать текст в какую-либо модель, нам нужно либо преобразовать этот текст, либо вытащить из него фичи, например, сколько раз употреблялось в тексте 'пакет Яровой'. В нашей задачи у нас было 163 фичи:
Первые 160 - это фичи Topic Modeling-а (отношение к каждой из 40 тем для всех 4-х новостей)
3 фичи - это косинусная мера зависимости каждой из трёх с четвёртой.

А теперь подробнее о фичах:
Topic Modeling это одна из проблем машинного обучения без учителя - мы не знаем к каким темам относятся документы. Грубо говоря: у нас есть 10k документов лежащих в одном месте и нам нужно разбить их на темы. В Topic Modeling есть очень много разных решений, но перепробовав основную часть мы выбрали наилучшее, что подходило нам.
Мы разбили все новости на 40 тем.

Наивное решение

Для того чтобы оценивать все последующие модели, мы решили попробовать сделать "тупое" решение: мы достали из каждого текста имена собственные (например, Путин, Украина и т.д.), нормализовали их и с помощью логов посчитали метрику MAP@10 (почему она - чуть ниже).

У нас получилось 0.007. Какой-никакой, но результат.

Метрики

[написать, упомянуть что Саша предложил MAP@10, сделать линк на их статью]

Первые исследования

После этого решения, у нас появилась гипотеза, что рекомендовать новости - это не значит рекомендовать фильмы или какой-то другой контент. У новости есть время жизни - небольшой промежуток времени, когда она актуальна.

Мы решили проверить это исследованиями и нарисовали распределение просмотров новости по часам:

[твой график]

Оказалось, что время жизни новости - всего 5 часов и рекомендовать стоит новости из этого промежутка.

Контентная модель

[тут про LDA и все такое]

Коллаборативная фильтрация

[стандартное определение, плюс немного про косинусную меру]

Гибридная модель

[о рандом форест и том, что получилось в конце]

Послесловие

[философия о jupiter => production и все такое]
